<!--
  SYNC IMPACT REPORT
  ==================
  Version change: 0.0.0 → 1.0.0 (MAJOR - initial constitution)
  
  Modified principles: N/A (initial creation)
  
  Added sections:
  - 6 Core Principles (Spec-Driven, No Manual Code, Test-First, Progressive Evolution, AI-Native Architecture, Cloud-Native Readiness)
  - Technology Stack Constraints
  - Development Workflow
  - Governance
  
  Removed sections: N/A
  
  Templates requiring updates:
  - ✅ .specify/templates/plan-template.md (no changes needed - Constitution Check section exists)
  - ✅ .specify/templates/spec-template.md (no changes needed - compatible structure)
  - ✅ .specify/templates/tasks-template.md (no changes needed - phase structure compatible)
  
  Follow-up TODOs: None
-->

# Evolution of Todo Constitution

## Core Principles

### I. Spec-Driven Development (NON-NEGOTIABLE)

All implementation MUST follow the Spec-Driven Development workflow. No code is written without a specification.

- Every feature MUST have a specification in `specs/<phase-name>/spec.md` before implementation
- The workflow is: `/sp.specify` → `/sp.plan` → `/sp.tasks` → `/sp.implement`
- Specifications MUST include acceptance criteria in Given-When-Then format
- All changes MUST be traceable back to a specification requirement
- Prompt History Records (PHRs) MUST be created for every significant interaction

**Rationale**: This ensures alignment between requirements and implementation, enables traceability, and produces auditable development history for hackathon evaluation.

### II. No Manual Code (NON-NEGOTIABLE)

All code MUST be generated by Claude Code from specifications. Manual coding is strictly prohibited.

- Developers act as Product Architects, not syntax writers
- If generated code is incorrect, refine the specification and regenerate
- Implementation iterations MUST be documented in PHRs
- Code review focuses on spec accuracy, not implementation details
- The spec is the source of truth; code is a derived artifact

**Rationale**: This is a core hackathon requirement. Judges will evaluate the process, prompts, and iterations used to generate correct output from specifications.

### III. Test-First Development

Tests MUST be specified before implementation. Red-Green-Refactor cycle is mandatory.

- Test cases MUST be defined in specifications as acceptance scenarios
- Tests MUST fail before implementation (Red phase)
- Implementation makes tests pass (Green phase)
- Code can be refactored only when tests pass (Refactor phase)
- Each user story MUST be independently testable
- Minimum 80% test coverage for core functionality

**Rationale**: Test-first ensures specifications are testable and implementation is verifiable. Independent story testing enables incremental MVP delivery.

### IV. Progressive Phase Evolution

The project evolves through 5 distinct phases. Each phase builds upon the previous.

- **Phase I**: Python Console App (in-memory, Basic Level features)
- **Phase II**: Full-Stack Web App (Next.js + FastAPI + Neon PostgreSQL)
- **Phase III**: AI Chatbot (OpenAI Agents SDK + MCP SDK + ChatKit)
- **Phase IV**: Local Kubernetes (Minikube + Helm + AIOps tools)
- **Phase V**: Cloud Deployment (AKS/GKE/OKE + Kafka + Dapr)

Phase constraints:
- Phases MUST be completed in order (no skipping)
- Each phase MUST have its own specification directory
- Code from previous phases SHOULD be refactored, not rewritten
- Breaking changes MUST be documented in ADRs

**Rationale**: Progressive evolution simulates real-world software development from prototype to production-grade distributed system.

### V. AI-Native Architecture

Phases III-V MUST implement AI-powered conversational interface using specified technologies.

- OpenAI Agents SDK for AI agent logic
- Official MCP SDK for exposing task operations as tools
- OpenAI ChatKit for frontend conversational UI
- Stateless chat endpoints with database-persisted conversation state
- Natural language MUST support all Basic Level operations (Add, Delete, Update, View, Complete)

MCP Tools requirements:
- `add_task`: Create new task with user_id, title, optional description
- `list_tasks`: Retrieve tasks with optional status filter
- `complete_task`: Mark task as complete by task_id
- `delete_task`: Remove task by task_id
- `update_task`: Modify task title or description

**Rationale**: AI-native architecture is a core hackathon objective, demonstrating integration of conversational AI with backend services via standardized protocols.

### VI. Cloud-Native Readiness

Phases IV-V MUST follow cloud-native principles for deployment.

- Applications MUST be containerized with Docker
- Kubernetes manifests MUST use Helm charts
- AIOps tools (kubectl-ai, kagent, Gordon) SHOULD be used for operations
- Dapr MUST be used for distributed application runtime in Phase V
- Event-driven architecture with Kafka for advanced features
- CI/CD pipeline MUST be implemented for cloud deployment

Infrastructure requirements:
- Local: Minikube for Kubernetes
- Cloud: Azure AKS, Google GKE, or Oracle OKE
- Database: Neon Serverless PostgreSQL (external)
- Event streaming: Kafka (Strimzi self-hosted) or Redpanda Cloud

**Rationale**: Cloud-native deployment demonstrates production-readiness and mastery of modern DevOps practices.

## Technology Stack Constraints

### Mandatory Technologies by Phase

| Phase | Frontend | Backend | Database | AI/ML | Infrastructure |
|-------|----------|---------|----------|-------|----------------|
| I | N/A | Python 3.13+ | In-memory | N/A | UV package manager |
| II | Next.js 16+ | FastAPI | Neon PostgreSQL | N/A | Docker |
| III | OpenAI ChatKit | FastAPI | Neon PostgreSQL | OpenAI Agents SDK, MCP SDK | Docker |
| IV | OpenAI ChatKit | FastAPI | Neon PostgreSQL | OpenAI Agents SDK, MCP SDK | Minikube, Helm |
| V | OpenAI ChatKit | FastAPI | Neon PostgreSQL | OpenAI Agents SDK, MCP SDK | AKS/GKE/OKE, Kafka, Dapr |

### Authentication

- Phase II+: Better Auth with JWT tokens
- JWT shared secret between frontend and backend
- All API endpoints MUST require valid JWT token
- User data isolation: each user sees only their tasks

### Monorepo Structure

```
hackathon-todo/
├── .specify/memory/constitution.md
├── specs/
│   ├── phase-1-console/
│   ├── phase-2-web/
│   ├── phase-3-chatbot/
│   ├── phase-4-k8s/
│   └── phase-5-cloud/
├── src/                    # Phase I
├── frontend/               # Phase II+
├── backend/                # Phase II+
├── docker/
├── k8s/
├── helm/
├── history/
│   ├── prompts/
│   └── adr/
├── CLAUDE.md
├── AGENTS.md
└── README.md
```

## Development Workflow

### Per-Feature Workflow

1. **Specify**: Run `/sp.specify` to create feature specification
2. **Clarify**: Run `/sp.clarify` if requirements are ambiguous
3. **Plan**: Run `/sp.plan` to create technical implementation plan
4. **ADR**: Run `/sp.adr` for significant architectural decisions
5. **Tasks**: Run `/sp.tasks` to break down into executable tasks
6. **Implement**: Run `/sp.implement` to generate code from specs
7. **Test**: Verify tests pass and acceptance criteria are met
8. **PHR**: Create Prompt History Record for the session
9. **Commit**: Run `/sp.git.commit_pr` to commit and create PR

### Quality Gates

- [ ] Specification reviewed and approved before planning
- [ ] Plan reviewed and approved before task breakdown
- [ ] All tasks have clear acceptance criteria
- [ ] Tests written and failing before implementation
- [ ] All tests passing after implementation
- [ ] No manual code written (all generated from specs)
- [ ] PHR created for the session
- [ ] Code committed with meaningful message

### PHR Requirements

Every significant interaction MUST produce a PHR containing:
- Full prompt text (verbatim)
- Response summary
- Files created/modified
- Tests run
- Outcome evaluation

PHR routing:
- Constitution changes → `history/prompts/constitution/`
- Feature work → `history/prompts/<feature-name>/`
- General → `history/prompts/general/`

## Governance

### Amendment Process

1. Proposed changes MUST be documented with rationale
2. Changes affecting core principles require team review
3. All amendments MUST update the version number
4. Breaking changes require migration plan

### Versioning Policy

- **MAJOR**: Principle removals, redefinitions, or incompatible changes
- **MINOR**: New principles, sections, or expanded guidance
- **PATCH**: Clarifications, wording fixes, non-semantic refinements

### Compliance

- All PRs MUST verify compliance with this constitution
- Violations MUST be justified in Complexity Tracking section of plan
- Constitution supersedes all other development practices
- Use CLAUDE.md and AGENTS.md for runtime development guidance

**Version**: 1.0.0 | **Ratified**: 2026-02-07 | **Last Amended**: 2026-02-07
